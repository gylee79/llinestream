{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the LlineStream application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "name": {
          "type": "string",
          "description": "User's full name."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "phone": {
          "type": "string",
          "description": "User's contact phone number in 010-XXXX-XXXX format."
        },
        "dob": {
          "type": "string",
          "description": "User's birth date in YYYY-MM-DD format."
        },
        "createdAt": {
          "type": "string",
          "description": "The date the user joined the application.",
          "format": "date-time"
        },
        "role": {
          "type": "string",
          "description": "The role of the user.",
          "enum": ["user", "admin"]
        }
      },
      "required": [
        "id",
        "name",
        "email",
        "phone",
        "dob",
        "createdAt",
        "role"
      ]
    },
    "Field": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Field",
      "type": "object",
      "description": "Represents a top-level category for content (e.g., Education, Movies).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Field entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the field (e.g., Education)."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "Classification": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Classification",
      "type": "object",
      "description": "Represents a genre or category that can be subscribed to (e.g., Coding, Action).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Classification entity."
        },
        "fieldId": {
          "type": "string",
          "description": "Reference to Field. (Relationship: Field 1:N Classification)"
        },
        "name": {
          "type": "string",
          "description": "Name of the classification (e.g., Coding)."
        },
        "description": {
          "type": "string",
          "description": "Description of the classification."
        },
        "prices": {
          "type": "object",
          "description": "Price map for different subscription durations.",
          "properties": {
            "day1": { "type": "number" },
            "day30": { "type": "number" },
            "day60": { "type": "number" },
            "day90": { "type": "number" }
          }
        }
      },
      "required": [
        "id",
        "fieldId",
        "name",
        "description",
        "prices"
      ]
    },
    "Course": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Course",
      "type": "object",
      "description": "Represents a video series within a classification (e.g., React Master Class).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Course entity."
        },
        "classificationId": {
          "type": "string",
          "description": "Reference to Classification. (Relationship: Classification 1:N Course)"
        },
        "name": {
          "type": "string",
          "description": "Name of the course (e.g., React Master Class)."
        },
        "description": {
          "type": "string",
          "description": "Description of the course."
        },
        "thumbnailUrl": {
          "type": "string",
          "description": "URL of the course thumbnail image.",
          "format": "uri"
        },
        "thumbnailHint": {
          "type": "string",
          "description": "Hint for AI to find a relevant image."
        }
      },
      "required": [
        "id",
        "classificationId",
        "name",
        "description",
        "thumbnailUrl",
        "thumbnailHint"
      ]
    },
    "Episode": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Episode",
      "type": "object",
      "description": "Represents an individual video within a course.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Episode entity."
        },
        "courseId": {
          "type": "string",
          "description": "Reference to Course. (Relationship: Course 1:N Episode)"
        },
        "title": {
          "type": "string",
          "description": "Title of the episode."
        },
        "duration": {
          "type": "number",
          "description": "Duration of the episode in seconds."
        },
        "isFree": {
          "type": "boolean",
          "description": "Indicates whether the episode is free to watch."
        },
        "videoUrl": {
          "type": "string",
          "description": "URL of the video file.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "courseId",
        "title",
        "duration",
        "isFree",
        "videoUrl"
      ]
    },
    "Policy": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Policy",
      "type": "object",
      "description": "Represents the legal policies of the application (e.g., Terms of Service, Privacy Policy).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Policy entity."
        },
        "slug": {
          "type": "string",
          "enum": ["terms", "privacy", "refund"]
        },
        "title": {
          "type": "string",
          "description": "Title of the policy."
        },
        "content": {
          "type": "string",
          "description": "The text content of the policy."
        }
      },
      "required": [
        "id",
        "slug",
        "title",
        "content"
      ]
    },
    "Subscription": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Subscription",
      "type": "object",
      "description": "Represents a user's subscription to a specific classification.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Subscription entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Subscription)"
        },
        "classificationId": {
          "type": "string",
          "description": "Reference to Classification. (Relationship: Classification 1:N Subscription)"
        },
        "expiresAt": {
          "type": "string",
          "description": "End date of the subscription.",
          "format": "date-time"
        },
        "purchasedAt": {
            "type": "string",
            "description": "Start date of the subscription.",
            "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "classificationId",
        "purchasedAt",
        "expiresAt"
      ]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/entities/User"
          },
          "description": "Stores user profile information. Authorization is based on path ownership (`request.auth.uid == userId`) or admin role.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/fields/{fieldId}",
        "definition": {
          "entityName": "Field",
          "schema": {
            "$ref": "#/entities/Field"
          },
          "description": "Stores top-level content categories (e.g., Education, Movies). Authorization: Open read access, restricted write access to admins.",
          "params": [
            {
              "name": "fieldId",
              "description": "The unique identifier for the field."
            }
          ]
        }
      },
      {
        "path": "/classifications/{classificationId}",
        "definition": {
          "entityName": "Classification",
          "schema": {
            "$ref": "#/entities/Classification"
          },
          "description": "Stores content classifications or genres (e.g., Coding, Action). Authorization: Open read access, restricted write access to admins.",
          "params": [
            {
              "name": "classificationId",
              "description": "The unique identifier for the classification."
            }
          ]
        }
      },
      {
        "path": "/courses/{courseId}",
        "definition": {
          "entityName": "Course",
          "schema": {
            "$ref": "#/entities/Course"
          },
          "description": "Stores video series within a classification (e.g., React Master Class). Authorization: Open read access, restricted write access to admins.",
          "params": [
            {
              "name": "courseId",
              "description": "The unique identifier for the course."
            }
          ]
        },
        "subcollections": [
          {
            "path": "/episodes/{episodeId}",
            "definition": {
              "entityName": "Episode",
              "schema": {
                "$ref": "#/entities/Episode"
              },
              "description": "Stores individual videos within a course. Authorization: Read access requires subscription, write access for admins.",
              "params": [
                { "name": "episodeId", "description": "The unique identifier for the episode." }
              ]
            }
          }
        ]
      },
      {
        "path": "/policies/{policyId}",
        "definition": {
          "entityName": "Policy",
          "schema": {
            "$ref": "#/entities/Policy"
          },
          "description": "Stores legal policies (e.g., Terms of Service, Privacy Policy). Authorization: Open read access, restricted write access to admins.",
          "params": [
            {
              "name": "policyId",
              "description": "The unique identifier for the policy."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/subscriptions/{subscriptionId}",
        "definition": {
          "entityName": "Subscription",
          "schema": {
            "$ref": "#/entities/Subscription"
          },
          "description": "Stores user subscriptions. Authorization: Only the user can read/write their own subscriptions (`request.auth.uid == userId`).",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "subscriptionId",
              "description": "The unique identifier for the subscription."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support LlineStream's video streaming and subscription model. User roles are managed via the `role` field within the `users` document for secure and efficient admin checks in security rules. User data is self-contained. Content is structured hierarchically (Field -> Classification -> Course -> Episode) for easy browsing and management. Subscriptions are stored under each user to easily query a user's entitlements."
  }
}
